<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Monitoring Dashboard</title>

  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #6A329F 0%, #3B1C5B 100%);
      font-family: 'Segoe UI', sans-serif;
      color: white;
    }

    .top-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 18px 24px;
      background: rgba(26, 26, 26, 0.35);
    }

    .logo {
      font-size: 26px;
      font-weight: bold;
    }

    .nav-buttons {
      display: flex;
      gap: 25px;
    }

    .nav-buttons button {
      background: transparent;
      color: #f2f2f2;
      font-size: 18px;
      padding: 8px 14px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      transition: 0.25s;
    }

    .nav-buttons button.active {
      background: linear-gradient(135deg, #C9A8E3 0%, #6A329F 100%);
      font-weight: 700;
      color: #fff;
    }

    .section-title {
      margin: 12px 16px;
      font-size: 22px;
      font-weight: bold;
    }

    section {
      display: flex;
      overflow-x: auto;
      gap: 20px;
      padding: 12px;
    }

    .card {
      background: rgba(255, 255, 255, 0.12);
      backdrop-filter: blur(10px);
      border-radius: 18px;
      min-width: 300px;
      padding: 22px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 8px 25px rgba(0,0,0,0.4);
      color: #F6EDFF;
      transition: 0.25s;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 35px rgba(0,0,0,0.55);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .title { font-size: 20px; font-weight: 600; }
    .ids { font-size: 14px; opacity: 0.8; }

    .main-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    .main-value {
      font-size: 36px;
      font-weight: 800;
    }

    .sub-line {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
  </style>
</head>

<body>

  <!-- NAVBAR -->
  <div class="top-nav">
    <div class="logo">LOGO</div>

    <div class="nav-buttons">
      <button class="active" onclick="window.location.href='index.html'">Monitoring</button>
      <button onclick="window.location.href='analysis.html'">Analysis</button>
      <button onclick="window.location.href='history.html'">History</button>
      <button onclick="window.location.href='settings.html'">Settings</button>
    </div>
  </div>

  <!-- CONTENT -->
  <h2 class="section-title">Water Level</h2>
  <section id="distance"></section>

  <h2 class="section-title">Temperature</h2>
  <section id="temperature"></section>

  <h2 class="section-title">Flow</h2>
  <section id="flow"></section>

  <h2 class="section-title">Other</h2>
  <section id="other"></section>

<script>
/* ================= BASE API URL ===================== */
const BASE_URL =
"https://script.google.com/macros/s/AKfycby2xEnzT9PavcBIEXm6JCVNRIy9rqr7K2-wO0coaoNaC3ElqTQ7KmMcFjxUNL5gb_M12Q/exec";

/* ================= LIVE REFRESH (1 second) ===================== */
setInterval(loadData, 1000);
loadData();

function loadData() {
  fetch(`${BASE_URL}?page=apimonitoring`)
    .then(res => res.json())
    .then(data => {
      renderCategory("distance", data.distance || []);
      renderCategory("temperature", data.temperature || []);
      renderCategory("flow", data.flow || []);
      renderCategory("other", data.none || []);
    })
    .catch(err => console.error("Fetch Error:", err));
}

function renderCategory(sectionID, array) {
  const container = document.getElementById(sectionID);
  container.innerHTML = ""; // Clear old

  array.forEach(item => {
    const card = document.createElement("div");
    card.className = "card";

    card.style.borderLeft = `6px solid #f890ec`;

    card.innerHTML = `
      <div class="card-header">
        <span class="title">${item.label}</span>
        <span class="ids">C${item.controllerID}:S${item.sensorID}</span>
      </div>

      <div class="main-line">
        <span>${item.mainLabel}</span>
        <span class="main-value">${item.mainData}${item.mainUnit || ""}</span>
      </div>

      <div class="sub-line">
        <span>${item.subLabel}</span>
        <span class="sub-value">${item.subData}${item.subUnit || ""}</span>
      </div>
    `;

    container.appendChild(card);
  });
}
</script>

</body>
</html>
